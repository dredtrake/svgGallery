"use strict";var SvgGallery=function(a,b){var c=function(b){var c={_item:"canvas",_dataURL:"",_data:"",_folderSrc:"",_width:"1920",_height:"1080",_preserveAspectRatio:"xMidYMid slice",_transition:"squares",onclick:function(){return!1},_duration:650,_animationUpType:">",_animationDownType:"<",_order:"desc",_loop:!1,onanimate:function(){return!1},ready:function(){return!1}};this.options=a.extend({},c,b),this.images=[],this.draw="",this.i=null};return c.prototype={constructor:c,options:{},svg:null,_width:0,_height:0,diag:null,circ:null,rect:null,_angle:null,_isSliding:0,_maxSliding:null,isLocalStorage:0,simpleUp:0,init:function(){if(!this.options._dataURL&&!this.options._data)return void $("#"+this.options._item).html("<p>Please feed me with some yummy json!!</p>");this._width=this.options._width,this._height=this.options._height,this._angle=this.getAngle(0,this._height,this._width,0),this.draw=b(this.options._item),this.svg=a("#"+this.options._item).find("svg")[0],this.svg.setAttribute("viewBox","0 0 "+this._width+" "+this._height),this.svg.setAttribute("preserveAspectRatio",this.options._preserveAspectRatio);var c=this;this.options._data?(this._maxSliding=this.options._data.length,this.drawScene(this.options._data)):a.ajax({url:c.options._dataURL,type:"get",dataType:"json",success:function(a){c._maxSliding=a.length,c.drawScene(a)}})},drawScene:function(a){var b=a.length;for(this.i=0;this.i<b;++this.i){var c=this.options._folderSrc||"";this.images[this.i]=this.draw.image(c+a[this.i].imgSrc,this._width,this._height),this.images[this.i].style("cursor","pointer"),this.images[this.i].data("id",a[this.i].id),this.images[this.i].data("nom",a[this.i].nom),this.images[this.i].data("description",a[this.i].description),this.images[this.i].click(this.options.onclick)}this.i-=1,this.circ=this.draw.circle(.2),this.circ.back(),this.rect=this.draw.rect(.2,.2),this.rect.back(),this.diag=this.draw.rect(.2,this._height),this.diag.back(),this.bindMouseWheel(),this.options.ready()},extractDelta:function(a){return a.wheelDelta?a.wheelDelta:a.detail?-40*a.detail:a.originalEvent&&a.originalEvent.wheelDelta?a.originalEvent.wheelDelta:void 0},getAngle:function(a,b,c,d){var e=Math.atan((c-a)/(b-d))/(Math.PI/180);return e=Math.round(e),e>0?d>b?e:180+e:c>a?180+e:360+e},bindMouseWheel:function(){this.svg.addEventListener?(this.svg.addEventListener("mousewheel",this.animateGallery.bind(this),!1),this.svg.addEventListener("DOMMouseScroll",this.animateGallery.bind(this),!1)):this.svg.attachEvent("onmousewheel",this.animateGallery.bind(this))},animateGallery:function(a){var b=this.extractDelta(a);switch(this.options._transition){case"diagonales":this.diagonales(b);break;case"circles":this.circles(b);break;case"squares":this.squares(b);break;default:this.diagonales(b)}},diagonales:function(a){var b=this;if(!this._isSliding)if(0>a){if(!(this.i>0))return;this._isSliding=1,this.simpleUp=0,--this.i,this.diag.attr({width:.2,height:this._height}).move(this._width,0).skew(360-this._angle,0),this.images[this.i].clipWith(this.diag).front(),this.diag.animate(this.options._duration,this.options._animationDownType).move(0,0).attr("width",2*this._width).after(function(){this.attr("width",0),b._isSliding=0,b.images[b.i].unclip(),b.options.onanimate()})}else{if(this.i===this._maxSliding-1)return;this._isSliding=1,this.simpleUp&&this.images[this.i+1].front().backward(),this.images[this.i].clipWith(this.diag),this.diag.attr({width:2*this._width,height:this._height}).move(0,0).animate(this.options._duration,this.options._animationUpType).move(this._width,0).attr("width",.2).after(function(){this.attr("width",0),b.images[b.i].unclip(),b._isSliding=0,++b.i,b.images[b.i].front(),b.options.onanimate()}),this.simpleUp=1}},circles:function(a){var b=this;if(!this._isSliding)if(0>a){if(!(this.i>0))return;this._isSliding=1,this.simpleUp=0,--this.i,this.circ.attr("rx",.2).attr("ry",.2),this.circ.center(.1,.1).move(this._width/2,this._height/2),this.images[this.i].clipWith(this.circ).front(),this.circ.animate(this.options._duration,this.options._animationDownType).center(this._width/2,this._height/2).attr("rx",this._width).attr("ry",this._width).after(function(){b._isSliding=0,b.images[b.i].unclip(),this.attr("rx",0),this.attr("ry",0),b.options.onanimate()})}else{if(this.i===this._maxSliding-1)return;this._isSliding=1,this.simpleUp&&this.images[this.i+1].front().backward(),this.images[this.i].clipWith(this.circ),this.circ.attr("rx",this._width).attr("ry",this._width).center(this._width/2,this._height/2).animate(this.options._duration,this.options._animationUpType).center(.1,.1).move(this._width/2,this._height/2).attr("rx",.2).attr("ry",.2).after(function(){this.attr("rx",0),this.attr("ry",0),b.images[b.i].unclip(),b._isSliding=0,++b.i,b.images[b.i].front(),b.options.onanimate()}),this.simpleUp=1}},squares:function(a){var b=this;if(!this._isSliding)if(0>a){if(!(this.i>0))return;this._isSliding=1,this.simpleUp=0,--this.i,this.rect.attr({width:.2,height:.2}).move(this._width/2,this._height/2),this.images[this.i].clipWith(this.rect).front(),this.rect.animate(this.options._duration,this.options._animationDownType).move(0,-(this._height/2)).attr({width:this._width,height:this._width}).after(function(){b._isSliding=0,b.images[b.i].unclip(),this.attr({width:0,height:0}),b.options.onanimate()})}else{if(this.i===this._maxSliding-1)return;this._isSliding=1,this.simpleUp&&this.images[this.i+1].front().backward(),this.images[this.i].clipWith(this.rect),this.rect.attr({width:this._width,height:this._width}).move(0,-(this._height/2)).animate(this.options._duration,this.options._animationUpType).move(this._width/2,this._height/2).attr({width:.2,height:.2}).after(function(){this.attr({width:0,height:0}),b.images[b.i].unclip(),b._isSliding=0,++b.i,b.images[b.i].front(),b.options.onanimate()}),this.simpleUp=1}},bubbles:function(){},swipe:function(){},getID:function(){return this.images[this.i].data("id")}},c}($,SVG);